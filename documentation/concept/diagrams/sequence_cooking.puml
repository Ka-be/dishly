@startuml sequence_cooking
actor Utilisateur as user
participant "Expo App" as app
participant "Timer Manager" as timer
participant "Notification Service" as notif

user -> app: Ouvre une recette
activate app
app --> user: Affiche recette (tabs: IngrÃ©dients / Ã‰tapes)

user -> app: Passe en "Mode Pas-Ã -Pas"
app -> app: Affiche Ã‰tape 1 en plein Ã©cran

user -> app: Lit l'Ã©tape

alt Ã‰tape avec timer
  app --> user: Affiche bouton "DÃ©marrer timer (20 min)"
  user -> app: Clique sur "DÃ©marrer timer"
  
  app -> timer: startTimer(stepId, 1200 secondes)
  activate timer
  timer -> timer: Ajoute timer Ã  la pile
  timer --> app: Timer dÃ©marrÃ©
  app --> user: Timer affichÃ© dans la barre du haut
  
  user -> app: Swipe vers la droite
  app -> app: Affiche Ã‰tape 2
  
  note right
    Le timer continue de tourner
    en arriÃ¨re-plan mÃªme si
    l'utilisateur change d'Ã©tape
  end note
  
  ... Temps passe (20 minutes) ...
  
  timer -> timer: Timer atteint 0
  timer -> notif: DÃ©clenche notification
  activate notif
  notif --> user: ðŸ”” Notification "Ã‰tape 1 terminÃ©e"
  notif -> app: Vibration + son
  deactivate notif
  
  app --> user: Affiche popup "Ã‰tape 1 : Sortir du four"
  deactivate timer
end

user -> app: Continue les Ã©tapes suivantes
app -> app: Swipe entre les Ã©tapes

user -> app: Termine la derniÃ¨re Ã©tape
app --> user: "Recette terminÃ©e ! ðŸŽ‰"
app --> user: Options : "Retour" | "Recommencer"

deactivate app
@enduml